seml:
  executable: /home/icb/alessandro.palma/imCPA/compert/main.py
  name: bbbc025_trainable_emb_change_flr_res
  output_dir: /lustre/groups/ml01/workspace/alessandro.palma/imCPA_official/results/bbbc025/bbbc025_sweep_flr
  conda_environment: imgCPA
  project_root_dir: /home/icb/alessandro.palma/imCPA

slurm:
  max_simultaneous_jobs: 10
  experiments_per_job: 1
  sbatch_options_template: GPU
  sbatch_options:
    gres: gpu:1       # num GPUs
    mem: 90G          # memory
    cpus-per-task: 6  # num cores
    time: 2-00:00     # max time, D-HH:MM

########## HUPERPARAMETER TUNING ##########

fixed: 
  # General parameters
  train.args.img_size: 96
  train.args.latent_dim: 100
  train.args.hidden_dim: 512
  train.args.style_dim: 64
  train.args.stochastic: True
  train.args.z_dimension: 32
  train.args.dim_in: 64

  # weight for objective functions
  train.args.lambda_reg: 1
  train.args.lambda_cyc: 1
  train.args.lambda_sty: 1
  train.args.lambda_ds: 1

  # training arguments
  train.args.total_iters: 100000
  train.args.ds_iter: 100000  
  train.args.resume_iter: 60000
  train.args.batch_size: 32
  train.args.val_batch_size: 3
  train.args.lr: 0.0001
  # train.args.f_lr: 0.000001
  train.args.beta1: 0
  train.args.beta2: 0.99
  train.args.weight_decay: 0.0001
  train.args.num_outs_per_domain: 10
  train.args.single_style: True
  train.args.ood_set: []
  train.args.mol_list: Null
  train.args.balanced: True
  train.args.trainable_emb: True
  train.args.dataset_name: 'bbbc025'
  train.args.n_channels: 5

  # misc
  train.args.mode: train
  train.args.num_workers: 6
  train.args.seed: 42  
    
  # directory for training
  train.args.image_path: /lustre/groups/ml01/workspace/alessandro.palma/imCPA_official/data/bbbc025/processed_data/subset_ds/image_df_corrected_subsample_300.pkl
  train.args.data_index_path: /lustre/groups/ml01/workspace/alessandro.palma/imCPA_official/data/bbbc025/processed_data/subset_ds/final_df_splits_subsample_300.csv
  train.args.embedding_path:  ''

  # Directories for results
  train.args.experiment_directory: /lustre/groups/ml01/workspace/alessandro.palma/imCPA_official/results/bbbc025/bbbc025_sweep_flr
  train.args.sample_dir: sample   # Name of directory for sampled images 
  train.args.checkpoint_dir: checkpoint  # Name of directory for checkpoints
  train.args.basal_vs_real_folder: basal_vs_real
  train.args.naming_key: [z_dimension, f_lr]
  train.args.embedding_folder: embeddings 
  train.args.resume_dir: '/lustre/groups/ml01/workspace/alessandro.palma/imCPA_official/results/bbbc025/bbbc025_sweep_flr/20220717'

  # face alignment
  train.args.augment_train: True 
  train.args.normalize: True

  # step size
  train.args.print_every: 10
  train.args.sample_every: 1000
  train.args.save_every: 1000
  train.args.eval_every: 10000

  # Neural network parameters
  train.args.encode_rdkit: True
  train.args.num_layers_mapping_net: 1
      
grid:
  train.args.f_lr:
    type: choice
    options:
      - 0.0001
      - 0.00001
      - 0.000001
